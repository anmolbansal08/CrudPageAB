<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <style type="text/css">
        #formsearch label {
            display: block;
            text-align: center;
            line-height: 150%;
            font-size: .85em;
        }

        #cfMessage-container {
            font-size: 12px;
        }
    </style>
    <script src="../../Scripts/jquery-1.7.2.js"></script>
    <script src="../../Scripts/CfiMessage.js"></script>

    <link href="../../Styles/bootstrap.css" rel="stylesheet" />
    <link href="../../Styles/Site.css" rel="stylesheet" />
    <link href="../../Styles/jquery.appendGrid-1.3.2.css" rel="stylesheet" />
    <link href="../../Styles/jquery-ui/jquery-ui-1.10.2.custom.css" rel="stylesheet" />
    <link href="../../Styles/CfiMessage.css" rel="stylesheet" />
    <link href="../../Styles/font-awesome.min.css" rel="stylesheet" />


    <script type="text/javascript">

        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }



        function ShowMessage(msgType, title, htmlText) {

            if (htmlText != "") {
                CallMessageBox(msgType, title, htmlText);
            }
        }


        ///MessageBox
        function CallMessageBox(msgType, title, msg, position, fadeInTime, fadeOutTime, timeout) {

            if (fadeInTime == undefined)
                fadeInTime = 200;
            if (fadeOutTime == undefined)
                fadeOutTime = 300;
            if (timeout == undefined)
                timeout = 2600;
            if (position == undefined)
                position = "cfMessage-top-right";
            InvokeMsg.options = {
                "debug": false,
                "positionClass": position,
                "onclick": null,
                "fadeIn": fadeInTime,
                "fadeOut": fadeOutTime,
                "timeOut": timeout

            }
            InvokeMsg[msgType](msg, title)
        }



        $(document).ready(function () {


            var ddlorigin = getParameterByName("Origin", "");
            var ddldestination = getParameterByName("Destination", "");
            var Date = getParameterByName("FlightDate", "");
            var leg = getParameterByName("leg", "");
            $.ajax({
                url: "../../SearchSchedule/GetSearchSchedule",
                async: false,
                type: "GET",
                dataType: "json",
                data: {
                    originCityname: ddlorigin, destinationcityname: ddldestination, date: Date, leg: leg, radiocheck: 1
                },
                contentType: "application/json; charset=utf-8", cache: false,
                success: function (result) {

                    if (result.radiocheck == "0") {
                        $('#theadid').html('');
                        $('#tbodyid').html('');
                        var Result = (result.listschedule);
                        var ResultRoute = (result.listRoutepath);
                        if (Result.length > 0) {
                            var j = 0;
                            var i = 0;
                            var k = 0;
                            for (; k < ResultRoute.length; k++) {


                                if (i == Result.length) {
                                    i = i - 1;
                                    j = j + 1;
                                    if (j == ResultRoute.length) {
                                        break;
                                    }

                                    else { thead_row += '<tr><td colspan="8"  style="color: blue;font-size: large;text-align:  center;">' + ResultRoute[j].ORIGINMAIN + '</td></tr>' }
                                }
                                else {
                                    thead_row += '<tr><td colspan="8"  style="color: blue;font-size: large;text-align:  center;">' + ResultRoute[j].ORIGINMAIN + '</td></tr>'
                                }
                                if (ResultRoute[j].id == Result[i].sno) {
                                    for (; i < Result.length;) {

                                        if (ResultRoute[j].id == Result[i].sno) {
                                            // thead_row += '<tr><td colspan="8"  style="color: blue;font-size: large;text-align:  center;">' + ResultRoute[j].ORIGINMAIN + '</td></tr>'
                                            //  thead_row += '<tr><td colspan="8"  style="color: blue;font-size: large;">' + Result[i].RoutePath + '</td></tr>'
                                            var columnsIn = Result[0];// Coulms Name geting from First Row
                                            thead_row += '<tr id="routeid">'
                                            for (var key in columnsIn) { // Printing Columns
                                                if (key == 'FlightNo') {
                                                    var keys = 'Flight No';
                                                    if (i == 0)

                                                        thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                    thead_row += "<td class='ui-widget-content' style='text-align: center;' id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                                }
                                                else if (key == 'FlightOrigin') {
                                                    var keys = 'Flight Origin';
                                                    if (i == 0)

                                                        thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                    thead_row += "<td class='ui-widget-content' style='text-align: center;' id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                                }
                                                else if (key == 'FlightDestination') {
                                                    var keys = 'Flight Destination';
                                                    if (i == 0)

                                                        thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                    thead_row += "<td class='ui-widget-content' style='text-align: center;' id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                                }
                                                else if (key == 'FlightDate') {
                                                    var keys = 'Flight Date';
                                                    if (i == 0)

                                                        thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                    thead_row += "<td class='ui-widget-content' style='text-align: center;' id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                                }
                                                else if (key == 'ETD') {
                                                    var keys = 'ETD/ETA';
                                                    if (i == 0)

                                                        thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                    thead_row += "<td class='ui-widget-content' style='text-align: center;' id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                                }
                                                else if (key == 'ETDGMT') {
                                                    var keys = 'ETD GMT/ETA GMT';
                                                    if (i == 0)

                                                        thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                    thead_row += "<td class='ui-widget-content' style='text-align: center;'  id=" + key + i + "> <label for='formsearch' maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                                }
                                                else if (key == 'CargoClassification') {
                                                    var keys = 'Mode of Operation';
                                                    if (i == 0)

                                                        thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                    thead_row += "<td class='ui-widget-content' style='text-align: center;'  id=" + key + i + "> <label for='formsearch' maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                                }

                                                else if (key == 'AircraftDescription') {
                                                    var keys = 'Aircraft Description';
                                                    if (i == 0)

                                                        thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                    thead_row += "<td class='ui-widget-content' style='text-align: center;'  id=" + key + i + "> <label for='formsearch' maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                                }
                                                else {

                                                    if (i == 0)

                                                        thead_body += "<td class='ui-widget-header' id=" + key + "> " + key + " </td>";

                                                    thead_row += "<td class='ui-widget-content' style='text-align: center;'  id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                                }

                                            }
                                            thead_row += '</tr>'
                                        }
                                        else {
                                            // thead_row += '<tr><td colspan="8"  style="color: blue;font-size: large;text-align:  center;">' + ResultRoute[j].ORIGINMAIN + '</td></tr>'
                                            //  thead_row += '<tr><td colspan="8"  style="color: blue;font-size: large;">' + Result[i].RoutePath + '</td></tr>'
                                            //var columnsIn = Result[0];// Coulms Name geting from First Row
                                            //thead_row += '<tr id="routeid">'
                                            //for (var key in columnsIn) { // Printing Columns
                                            //    if (i == 0)
                                            //        thead_body += "<td class='ui-widget-header' id=" + key + "> " + key + " </td>";

                                            //    thead_row += "<td class='ui-widget-content' style='text-align: center;'  id=" + key + i + "> <label for='formsearch' maxlength='100' style='width:100px;'>No flight found</label></td>";
                                            //}
                                            //thead_row += '</tr>'

                                            j++;
                                            i--;

                                        }
                                        i++
                                        if (i == Result.length) {
                                            break;

                                        }
                                        if (ResultRoute[j].id != Result[i].sno) {
                                            j++;
                                            thead_row += '<tr><td colspan="8"  style="color: blue;font-size: large;text-align:  center;">' + ResultRoute[j].ORIGINMAIN + '</td></tr>'


                                        }
                                    }

                                }
                                else {
                                    //thead_row += '<tr><td colspan="8"  style="color: blue;font-size: large;">' + ResultRoute[j].ORIGINMAIN + '</td></tr>'
                                    //  thead_row += '<tr><td colspan="8"  style="color: blue;font-size: large;">' + Result[i].RoutePath + '</td></tr>'
                                    var columnsIn = Result[0];// Coulms Name geting from First Row
                                    thead_row += '<tr id="routeid">'
                                    for (var key in columnsIn) { // Printing Columns
                                        //if (i == 0)
                                        //    thead_body += "<td class='ui-widget-header' id=" + key + "> " + key + " </td>";

                                        thead_row += "<td class='ui-widget-content' style='text-align: center;'  id=" + key + i + "> <label for='formsearch' maxlength='100' style='width:100px;'>no record found</label></td>";
                                    }
                                    thead_row += '</tr>'
                                    j++;
                                }
                            }
                        }
                        else {

                            thead_body += "<td class='ui-widget-header' </td>";

                            thead_row += "<td class='ui-widget-content'  align='center' style='margin-left: 573px;' ><label for='formsearch' maxlength='100' style='width:100px;font-size: large;'>No record found</label></td>";

                            thead_row += '</tr>'

                        }
                        $('#theadid').append('<tr>' + thead_body + '</tr>');
                        $('#tbodyid').append(thead_row);

                        if ($('#routeid').length > 0) {
                            $('[id*="RoutePath"]').remove();
                            $('[id*="sno"]').remove();

                        }






                    }

                    else {
                        $('#theadid').html('');
                        $('#tbodyid').html('');
                        var Result = (result.listschedule);
                        var thead_body = "";
                        var thead_row = "";

                        if (Result.length > 0) {
                            var j = 1;
                            var i = 0;
                            if (Result[i].sno == j) {
                                thead_row += '<tr><td colspan="8"  style="color: blue;font-size: large;">' + Result[i].RoutePath + '</td></tr>'
                                for (; i < Result.length; i++) {

                                    if (Result[i].sno == j) {

                                        var columnsIn = Result[0];// Coulms Name geting from First Row
                                        thead_row += '<tr id="routeid">'
                                        for (var key in columnsIn) { // Printing Columns
                                            if (key == 'FlightNo') {
                                                var keys = 'Flight No';
                                                if (i == 0)

                                                    thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                thead_row += "<td class='ui-widget-content' style='text-align: center;' id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                            }
                                            else if (key == 'FlightOrigin') {
                                                var keys = 'Flight Origin';
                                                if (i == 0)

                                                    thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                thead_row += "<td class='ui-widget-content' style='text-align: center;' id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                            }
                                            else if (key == 'FlightDestination') {
                                                var keys = 'Flight Destination';
                                                if (i == 0)

                                                    thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                thead_row += "<td class='ui-widget-content' style='text-align: center;' id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                            }
                                            else if (key == 'FlightDate') {
                                                var keys = 'Flight Date';
                                                if (i == 0)

                                                    thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                thead_row += "<td class='ui-widget-content' style='text-align: center;' id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                            }
                                            else if (key == 'ETD') {
                                                var keys = 'ETD/ETA';
                                                if (i == 0)

                                                    thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                thead_row += "<td class='ui-widget-content' style='text-align: center;' id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                            }
                                            else if (key == 'ETDGMT') {
                                                var keys = 'ETD GMT/ETA GMT';
                                                if (i == 0)

                                                    thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                thead_row += "<td class='ui-widget-content' style='text-align: center;'  id=" + key + i + "> <label for='formsearch' maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                            }
                                            else if (key == 'CargoClassification') {
                                                var keys = 'Mode of Operation';
                                                if (i == 0)

                                                    thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                thead_row += "<td class='ui-widget-content' style='text-align: center;'  id=" + key + i + "> <label for='formsearch' maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                            }

                                            else if (key == 'AircraftDescription') {
                                                var keys = 'Aircraft Description';
                                                if (i == 0)

                                                    thead_body += "<td class='ui-widget-header' id=" + key + "> " + keys + " </td>";

                                                thead_row += "<td class='ui-widget-content' style='text-align: center;'  id=" + key + i + "> <label for='formsearch' maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                            }
                                            else {

                                                if (i == 0)

                                                    thead_body += "<td class='ui-widget-header' id=" + key + "> " + key + " </td>";

                                                thead_row += "<td class='ui-widget-content' style='text-align: center;'  id=" + key + i + "> <label for='formsearch'  maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                            }

                                        }
                                        thead_row += '</tr>'
                                    }
                                    else {
                                        thead_row += '<tr><td colspan="8"  style="color: blue;font-size: large;">' + Result[i].RoutePath + '</td></tr>'
                                        var columnsIn = Result[0];// Coulms Name geting from First Row
                                        thead_row += '<tr id="routeid">'
                                        for (var key in columnsIn) { // Printing Columns
                                            if (i == 0)
                                                thead_body += "<td class='ui-widget-header' id=" + key + "> " + key + " </td>";

                                            thead_row += "<td class='ui-widget-content' style='text-align: center;'  id=" + key + i + "> <label for='formsearch' maxlength='100' style='width:100px;'>" + Result[i][key] + "</label></td>";
                                        }
                                        thead_row += '</tr>'
                                        j++;

                                    }
                                }

                            }
                        }
                        else {

                            thead_body += "<td class='ui-widget-header' </td>";

                            thead_row += "<td class='ui-widget-content'  align='center' style='margin-left: 573px;' ><label for='formsearch' maxlength='100' style='width:100px;font-size: large;'>No record found</label></td>";

                            thead_row += '</tr>'

                        }
                        $('#theadid').append('<tr>' + thead_body + '</tr>');
                        $('#tbodyid').append(thead_row);

                        if ($('#routeid').length > 0) {
                            $('[id*="RoutePath"]').remove();
                            $('[id*="sno"]').remove();

                        }

                    }
                }
            });

        });

    </script>
</head>
<body>
    <div id="Searchpopup">

        <table id="tblScedulepop"></table>
    </div>
    <div class="k-grid-header-wrap" id="grid">
        <br />
        <table id="tblsearchrateList" class="appendGrid ui-widget" style="margin-bottom:10px;" align="center">
            <thead class='ui-widget-header' style='text-align:center' id="theadid"></thead>
            <tbody id="tbodyid" class="ui-widget-content"></tbody>
        </table>
    </div>
</body>
</html>
