<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <script src="../../Scripts/jquery-1.7.2.js" type="text/javascript"></script>
    <script src="../../Scripts/json2.js"></script>
    <script src="../../JScript/UWS/jquery-barcode-2.0.2.js"></script>
    <title>Delivery Order Print</title>
   
    <style type="text/css">
        @media print {
            .watermark {
                opacity: 0.5;
                color: #808080;
                font-size: 150px;
                transform: rotate(300deg);
                -webkit-transform: rotate(300deg);
                position: absolute;
                margin-top: 80%;
                margin-left: 20%;
            }
        }

        .auto-style1 {
            height: 23px;
        }

        .auto-style3 {
        }

        .auto-style12 {
            width: 490px;
        }

        .auto-style36 {
            width: 133px;
            height: 40px;
        }

        .auto-style39 {
            width: 93px;
        }

        .auto-style40 {
            height: 42px;
        }

        table#table1, #table2, #table3 {
            /*width: 100%;
            margin-left: 15%;
            margin-right: 15%;*/
            width: 100%;
            font-size: smaller;
        }

        #content {
            position: absolute;
            z-index: 1;
        }

        .example {
            page-break-after: always;
        }

        .pagebreak {
            page-break-after: always;
        }

        @media screen {
            .watermark {
                opacity: 0.5;
                color: #808080;
                font-size: 150px;
                transform: rotate(300deg);
                -webkit-transform: rotate(300deg);
                position: absolute;
                margin-top: 15%;
                margin-left: 20%;
            }
        }
    </style>

    <script type="text/javascript">
        
        $(document).ready(function () {
            if (window.opener)
                userContext = window.opener.parent.userContext;
            GetDeliveryOrderPrint();
            $('#divPrint1').append($('#content').html());
            $('#divPrint1').find('.watermark').map(function () { return $(this).text('Original'); })
            $('#divPrint2').append($('#content').html());
            $('#divPrint2').find('.watermark').map(function () { return $(this).text('Copy1'); })
            $('#divPrint3').append($('#content').html());
            $('#divPrint3').find('.watermark').map(function () { return $(this).text('Copy2'); })
            $('#divPrint4').append($('#content').html());
            $('#divPrint4').find('.watermark').map(function () { return $(this).text('Copy3'); })
            $('#content').html("");

            if (IsCancel == "1") {
                $('#divPrint1').find('.watermark').map(function () { return $(this).text('Cancelled'); })
                $('#divPrint2').find('.watermark').map(function () { return $(this).text('Cancelled'); })
                $('#divPrint3').find('.watermark').map(function () { return $(this).text('Cancelled'); })
                $('#divPrint4').find('.watermark').map(function () { return $(this).text('Cancelled'); })
            }


            if (userContext.SysSetting.ICMSEnvironment == 'JT') {
               // $('#spnDefaultRemarks').html('If Shipment not cleared due to any reason, JT will not be responsible for returned Cargo unless "RECEIVED" Stamped and signed by Delivery Staff, RECEIPT');
                $("[id^=spnDefaultRemarks]").html('If Shipment not cleared due to any reason, JT will not be responsible for returned Cargo unless "RECEIVED" Stamped and signed by Delivery Staff, RECEIPT');
              
             
            }






        });

        var IsCancel = 0;
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        function GetDeliveryOrderPrint() {
            var DOSNo = getParameterByName("DOSNo", "");
            var Type = getParameterByName("Type", "");
            var InvoiceSNo = getParameterByName("InvoiceSNo", "");
            $.ajax({
                url: "../../Services/Import/DeliveryOrderService.svc/GetDeliveryOrderPrint",
                async: false,
                type: "GET",
                dataType: "json",
                data: { DOSNo: DOSNo, Type: Type, InvoiceSNo: InvoiceSNo },
                contentType: "application/json; charset=utf-8",
                cache: false,
                success: function (result) {
                    var ResultData = jQuery.parseJSON(result);
                    FinalData = ResultData.Table0;
                    FinalData1 = ResultData.Table1;
                    FinalData2 = ResultData.Table2;
                    LocationData = ResultData.Table3;
                    StorageData = ResultData.Table4;
                    var chargeType = "";
                    var Pieces = 0;
                    var chargeType1 = "";
                    var Pieces1 = 0;
                    var chargeType2 = "";
                    var Pieces2 = 0;
                    debugger;
                    if (FinalData.length > 0) {
                        Pieces = FinalData[0].Pieces;
                        $("#spnDONo").text(FinalData[0].DeliveryOrderNo);
                      //  $("#spnDate").text(FinalData[0].DeliveryOrderDate + ' ' + FinalData[0].DOTime);
                        $("#spnDate").text(FinalData[0].DOTime);
                        $("#spnConsignee").html(FinalData[0].Consignee + '</br>' + FinalData[0].HouseConsignee);
                        $("#spnNotify").html(FinalData[0].NOTIFY + '</br>' + FinalData[0].HouseNOTIFY);
                        $("#spnAirWaybillNo").text(FinalData[0].AWBNo);
                        $('#spnCCPP').text(FinalData[0].PaymentType)
                        $("#spnRctNoAndDate").text(FinalData[0].RctNo + "/" + (FinalData[0].RctDate == "01-Jan-1900" ? "" : FinalData[0].RctDate));
                        $("#spnRemarks").html(FinalData[0].Remarks);
                        $("#spnNameSignature").html(FinalData[0].Name);
                        $("#spnStaff").html(FinalData[0].Staff);
                        $("#spnHawbValue").html(FinalData[0].HouseNo);
                        $("#spnLocation").html(FinalData[0].Location);
                        $("#spntotalamountinwords").html(FinalData[0].TotalAmountInWord);

                       
                        $("#spnairplinename").html(FinalData[0].AIRLINENAME);
                        $("#spnairplinenamepage3").html(FinalData[0].AIRLINENAME);
                        $("#spnairplinenamepage2").html(FinalData[0].AIRLINENAME);
                        $("#spnCurrency1").html(FinalData[0].CurrencyCode);
                        $("#spnCurrency2").html(FinalData[0].CurrencyCode);
                        $("#spnCurrency3").html(FinalData[0].CurrencyCode);
                        $("#spnCurrency4").html(FinalData[0].CurrencyCode);
                        $("#spnCurrency5").html(FinalData[0].CurrencyCode);
                     

                        
                        

                        chargeType = FinalData[0].ChargesType;
                        if (FinalData[0].IsCancel == "False") {
                            $("#spnReprintCount").html(FinalData[0].PrintCount > 1 ? "(RE-PRINT: " + (FinalData[0].PrintCount - 1).toString() + ")" : "");
                            IsCancel = 0;
                        }
                        else {
                            IsCancel = 1;
                        }

                        $("#spnBarCode").barcode(FinalData[0].AWBNo, "code39", { barWidth: 1, barHeight: 40 });
                        Pieces1 = FinalData[0].Pieces;
                        $("#spnDONo1").text(FinalData[0].DeliveryOrderNo);
                      //  $("#spnDate1").text(FinalData[0].DeliveryOrderDate + ' ' + FinalData[0].DOTime);
                        $("#spnDate1").text(FinalData[0].DOTime);
                        $("#spnConsignee1").html(FinalData[0].Consignee + '</br>' + FinalData[0].HouseConsignee);
                        $("#spnNotify1").html(FinalData[0].NOTIFY + '</br>' + FinalData[0].HouseNOTIFY);
                        $("#spnAirWaybillNo1").text(FinalData[0].AWBNo);
                        $('#spnCCPP1').text(FinalData[0].PaymentType)
                        $("#spnRctNoAndDate1").text(FinalData[0].RctNo + "/" + (FinalData[0].RctDate == "01-Jan-1900" ? "" : FinalData[0].RctDate));
                        $("#spnRemarks1").html(FinalData[0].Remarks);
                        $("#spnNameSignature1").html(FinalData[0].Name);
                        $("#spnStaff1").html(FinalData[0].Staff);
                        $("#spnHawbValue1").html(FinalData[0].HouseNo);
                        $("#spnLocation1").html(FinalData[0].Location);
                        $("#spntotalamountinwords").html(FinalData[0].TotalAmountInWord);
                        chargeType1 = FinalData[0].ChargesType;
                        if (FinalData[0].IsCancel == "False") {
                            $("#spnReprintCount1").html(FinalData[0].PrintCount > 1 ? "(RE-PRINT: " + (FinalData[0].PrintCount - 1).toString() + ")" : "");
                            IsCancel = 0;
                        }
                        else {
                            IsCancel = 1;
                        }

                        $("#spnBarCode1").barcode(FinalData[0].AWBNo, "code39", { barWidth: 1, barHeight: 40 });

                        Pieces2 = FinalData[0].Pieces;
                        $("#spnDONo2").text(FinalData[0].DeliveryOrderNo);
                       // $("#spnDate2").text(FinalData[0].DeliveryOrderDate + ' ' + FinalData[0].DOTime
                         $("#spnDate2").text(FinalData[0].DOTime);
                        $("#spnConsignee2").html(FinalData[0].Consignee + '</br>' + FinalData[0].HouseConsignee);
                        $("#spnNotify2").html(FinalData[0].NOTIFY + '</br>' + FinalData[0].HouseNOTIFY);
                        $("#spnAirWaybillNo2").text(FinalData[0].AWBNo);
                        $('#spnCCPP2').text(FinalData[0].PaymentType)
                        $("#spnRctNoAndDate2").text(FinalData[0].RctNo + "/" + (FinalData[0].RctDate == "01-Jan-1900" ? "" : FinalData[0].RctDate));
                        $("#spnRemarks2").html(FinalData[0].Remarks);
                        $("#spnNameSignature2").html(FinalData[0].Name);
                        $("#spnStaff2").html(FinalData[0].Staff);
                        $("#spnHawbValue2").html(FinalData[0].HouseNo);
                        $("#spnLocation2").html(FinalData[0].Location);
                        $("#spntotalamountinwords").html(FinalData[0].TotalAmountInWord);
                        chargeType2 = FinalData[0].ChargesType;
                        if (FinalData[0].IsCancel == "False") {
                            $("#spnReprintCount2").html(FinalData[0].PrintCount > 1 ? "(RE-PRINT: " + (FinalData[0].PrintCount - 1).toString() + ")" : "");
                            IsCancel = 0;
                        }
                        else {
                            IsCancel = 1;
                        }

                        $("#spnBarCode2").barcode(FinalData[0].AWBNo, "code39", { barWidth: 1, barHeight: 40 });
                    }

                    var strdata = '';
                    var TotalPieces = 0;
                    if (FinalData1.length > 0) {
                        strdata = strdata + "<tr><td align='center' style='width:8%'>Pcs</td><td align='center' style='width:15%'>Gross Wt.</td><td align='center' style='width:52%'>Description of Goods</td><td align='center' style='width:25%'>Flight Details</td></tr>";
                        for (var num = 0; num < FinalData1.length; num++) {
                            strdata = strdata + "<tr><td style='border:1px solid black; padding-right:10px' align='center'><span id='spnPcs'>" + FinalData1[num].Pieces + "</span></td><td class='auto-style36' style='border:1px solid black;' align='center'><span id='spnGrossWt'>" + FinalData1[num].GrossWeight + "</span></td><td class='auto-style12' style='border:1px solid black; vertical-align:top;'><span id='spnDescription'>" + FinalData1[num].DescriptionOfGoods + "</span></td><td style='border:1px solid black;height:40px; vertical-align:top;'><span id='spnFlightDetails'>" + FinalData1[num].FlightDetails + "</span></td><tr>";
                            TotalPieces = Number(TotalPieces) + Number(Pieces);
                        }
                        $('#tabletrans').html(strdata);
                    }

                    var Particulars;
                    var Charges;
                    var TotalCharges = 0;
                    if (FinalData2.length > 0) {
                        var length = FinalData2.length > 5 ? 5 : FinalData2.length;
                        for (var num = 0; num < Number(length) ; num++) {
                            Particulars = Particulars + "</br>" + (FinalData2[num].IsWaveOff == "True" ? FinalData2[num].TariffName + '(Waived Off)' : FinalData2[num].TariffName);
                            Charges = Charges + "</br>" + FinalData2[num].ChargeValue;
                            if (FinalData2[num].IsWaveOff != "True")
                                TotalCharges = parseFloat(FinalData2[num].TotalAmount);
                        }

                        $("#spnParticulars").html(Particulars.replace(undefined, ""));
                        $("#spnAmount").html(Charges.replace(undefined, ""));
                        $("#spnTotal").html(" (" + chargeType + ")&nbsp;" + TotalCharges.toFixed(2));
                        $("#spntotalamountinwords").html(FinalData2[0].TotalAmountInWord);
                        $("#spntp").html(FinalData1[0].Pieces);
                        $("#spnwt").html(FinalData1[0].GrossWeight);

                        if (FinalData2.length > 5)
                            $("#Total").hide();
                    }

                    var strLocationData = '';
                    var AssignedPieces = 0;
                    if (LocationData.length > 0) {
                        strLocationData = strLocationData + "<tr><td align='center'>ULD No</td><td align='center'>HAWB No</td><td align='center'></td><td align='center'>Pieces</td><td align='center'>Location</td></tr>";
                        if ($("#spnHawbValue").html() != "") {
                            LocationData = $.grep(LocationData, function (value, i) {
                                return (value.HAWBNo == $("#spnHawbValue").html());
                            }

                            );



                            var length = LocationData.length > 2 ? 2 : LocationData.length;
                            for (var num = 0; num < Number(length) ; num++) {
                                if (Number(AssignedPieces) <= Number(TotalPieces)) {
                                    strLocationData = strLocationData + "<tr><td style='border:1px solid black; padding-right:10px' align='center'><span id='spnULDNo'>" + (Number(LocationData[num].StartPieces) > 0 ? "" : (LocationData[num].ULDNo != "BULK" ? LocationData[num].ULDNo : "")) + "</span></td><td style='border:1px solid black; padding-right:10px;border-right:none;' align='center'><span id='spnHAWBNo'>" + (LocationData[num].HAWBNo != "" ? LocationData[num].HAWBNo : "") + "</span></td><td class='auto-style36' style='border:1px solid black;border-left:none' align='center'><span id='spnStartPiece'></span></td><td class='auto-style36' style='border:1px solid black;' align='center'><span id='spnEndPiece'>" + (Number(TotalPieces) >= Number(LocationData[num].EndPieces) ? ((Number(TotalPieces) - Number(AssignedPieces)) >= LocationData[num].EndPieces ? LocationData[num].EndPieces : (Number(LocationData[num].StartPieces) == 1 ? (Number(TotalPieces) - Number(AssignedPieces)) : LocationData[num].EndPieces)) : Number(TotalPieces)) + "</span></td><td class='auto-style36' style='border:1px solid black;' align='center'><span id='spnLocation'>" + (LocationData[num].AssignLocation != "" ? LocationData[num].AssignLocation : LocationData[num].MovableLocation) + "</span></td><tr>";
                                    AssignedPieces = Number(AssignedPieces) + (Number(LocationData[num].StartPieces) == 1 ? Number(LocationData[num].EndPieces) : (Number(LocationData[num].EndPieces) - Number(LocationData[num].StartPieces)));
                                }
                            }
                        }
                        else {
                            var length = LocationData.length > 2 ? 2 : LocationData.length;
                            for (var num = 0; num < Number(length) ; num++) {
                                if (Number(AssignedPieces) <= Number(TotalPieces)) {
                                    strLocationData = strLocationData + "<tr><td style='border:1px solid black; padding-right:10px' align='center'><span id='spnULDNo'>" + (Number(LocationData[num].StartPieces) > 0 ? "" : (LocationData[num].ULDNo != "BULK" ? LocationData[num].ULDNo : "")) + "</span></td><td style='border:1px solid black; padding-right:10px;border-right:none;' align='center'><span id='spnHAWBNo'>" + (LocationData[num].HAWBNo != "" ? LocationData[num].HAWBNo : "") + "</span></td><td class='auto-style36' style='border:1px solid black;border-left:none' align='center'><span id='spnStartPiece'></span></td><td class='auto-style36' style='border:1px solid black;' align='center'><span id='spnEndPiece'>" + (Number(TotalPieces) >= Number(LocationData[num].EndPieces) ? ((Number(TotalPieces) - Number(AssignedPieces)) >= LocationData[num].EndPieces ? LocationData[num].EndPieces : (Number(LocationData[num].StartPieces) == 1 ? (Number(TotalPieces) - Number(AssignedPieces)) : LocationData[num].EndPieces)) : Number(TotalPieces)) + "</span></td><td class='auto-style36' style='border:1px solid black;' align='center'><span id='spnLocation'>" + (LocationData[num].AssignLocation != "" ? LocationData[num].AssignLocation : LocationData[num].MovableLocation) + "</span></td><tr>";
                                    AssignedPieces = Number(AssignedPieces) + (Number(LocationData[num].StartPieces) == 1 ? Number(LocationData[num].EndPieces) : (Number(LocationData[num].EndPieces) - Number(LocationData[num].StartPieces)));
                                }
                            }

                        }

                    }
                        // Added Else Condition To Handle Null Location Data because in case of Rush Handling DO The DeliveryBill Print Get Distorted  by rahul on 07-12-2017 
                    else {
                        strLocationData = strLocationData + "<tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>";
                    }
                    $('#Locationtrans').html(strLocationData);

                    var StorageRemarks = "";
                    if (StorageData.length > 0) {
                        StorageRemarks = "Free Storage <br>";
                        for (var num = 0; num < StorageData.length; num++) {
                            //Added By Rahul Kumar Singh on 27-06-2017 To chnge the Remarks Display Format
                            //StorageRemarks = StorageRemarks + (" For " + StorageData[num].PartNo + "Till " + StorageData[num].FOCTime + " /" + $("#spnRemarks").html());
                            StorageRemarks = StorageRemarks  + (" From " + StorageData[num].ATAGMT + " To " + StorageData[num].FOCTime + " <br>" + $("#spnRemarks").html());
                        }

                        $("#spnRemarks").html(StorageRemarks);
                    }

                    /*charges detail*/
                    if (FinalData2.length > 5) {
                        var Particulars2;
                        var Charges2;
                        var TotalCharges2 = 0;
                        if (FinalData2.length > 5) {
                            for (var num = 5; num < FinalData2.length; num++) {
                                Particulars2 = Particulars2 + "</br>" + (FinalData2[num].IsWaveOff == "True" ? FinalData2[num].TariffName + '(Waived Off)' : FinalData2[num].TariffName);
                                Charges2 = Charges2 + "</br>" + FinalData2[num].ChargeValue;
                                if (FinalData2[num].IsWaveOff != "True")
                                    TotalCharges2 = parseFloat(FinalData2[num].TotalAmount);
                            }
                            $("#spnParticulars2").html(Particulars2.replace(undefined, ""));
                            $("#spnAmount2").html(Charges2.replace(undefined, ""));
                            $("#spnTotal2").html(" (" + chargeType2 + ")&nbsp;" + TotalCharges2.toFixed(2));
                            $("#spntotalamountinwords2").html(FinalData2[0].TotalAmountInWord);
                            $("#spntp").html(FinalData1[0].Pieces);
                            $("#spnwt").html(FinalData1[0].GrossWeight);
                        }
                    }
                    else {
                        $("#table3").hide();
                        $("#pagebreak3").removeClass('pagebreak', '').removeClass('watermark', '').text('');
                    }

                    /*supplimentary page add by priya*/
                    if (LocationData.length > 2 || FinalData1.length > 5) {
                        var strdata = '';
                        if (FinalData1.length > 5) {
                            strdata = strdata + "<tr><td align='center' style='width:8%'>Pcs</td><td align='center' style='width:15%'>Gross Wt.</td><td align='center' style='width:52%'>Description of Goods</td><td align='center' style='width:25%'>Flight Details</td></tr>";
                            for (var num = 5; num < FinalData1.length; num++) {
                                strdata = strdata + "<tr><td style='border:0px solid black; padding-right:10px' align='center'><span id='spnPcs1'>" + FinalData1[num].Pieces + "</span></td><td class='auto-style36' style='border:0px solid black;' align='center'><span id='spnGrossWt1'>" + FinalData1[num].GrossWeight + "</span></td><td class='auto-style12' style='border:0px solid black; vertical-align:top;'><span id='spnDescription1'>" + FinalData1[num].DescriptionOfGoods + "</span></td><td style='border:0px solid black;height:40px; vertical-align:top;'><span id='spnFlightDetails1'>" + FinalData1[num].FlightDetails + "</span></td><tr>";
                            }

                            $('#tabletrans1').html(strdata);
                        }

                        /*Location*/
                        var strLocationData = '';
                        if (LocationData.length > 2 && (Number(AssignedPieces) < Number(TotalPieces))) {
                            strLocationData = strLocationData + "<tr><td align='center'>ULD No</td><td align='center'>HAWB No</td><td align='center'>Start Piece</td><td align='center'>End Piece</td><td align='center'>Location</td></tr>";
                            if ($("#spnHawbValue").html() != "") {
                                LocationData = $.grep(LocationData, function (value, i) {
                                    return (value.HAWBNo == $("#spnHawbValue").html());
                                });

                                var length = LocationData.length;
                                for (var num = 2; num < Number(length) ; num++) {
                                    if (Number(AssignedPieces) <= Number(TotalPieces)) {
                                        strLocationData = strLocationData + "<tr><td style='border:1px solid black; padding-right:10px' align='center'><span id='spnULDNo'>" + (Number(LocationData[num].StartPieces) > 0 ? "" : (LocationData[num].ULDNo != "BULK" ? LocationData[num].ULDNo : "")) + "</span></td><td style='border:1px solid black; padding-right:10px' align='center'><span id='spnHAWBNo'>" + (LocationData[num].HAWBNo != "" ? LocationData[num].HAWBNo : "") + "</span></td><td class='auto-style36' style='border:1px solid black;' align='center'><span id='spnStartPiece'>" + (LocationData[num].StartPieces != "0" ? LocationData[num].StartPieces : "") + "</span></td><td class='auto-style36' style='border:1px solid black;' align='center'><span id='spnEndPiece'>" + (Number(TotalPieces) >= Number(LocationData[num].EndPieces) ? ((Number(TotalPieces) - Number(AssignedPieces)) >= LocationData[num].EndPieces ? LocationData[num].EndPieces : (Number(LocationData[num].StartPieces) == 1 ? (Number(TotalPieces) - Number(AssignedPieces)) : LocationData[num].EndPieces)) : Number(TotalPieces)) + "</span></td><td class='auto-style36' style='border:1px solid black;' align='center'><span id='spnLocation'>" + (LocationData[num].AssignLocation != "" ? LocationData[num].AssignLocation : LocationData[num].MovableLocation) + "</span></td><tr>";
                                        AssignedPieces = Number(AssignedPieces) + (Number(LocationData[num].StartPieces) == 1 ? Number(LocationData[num].EndPieces) : (Number(LocationData[num].EndPieces) - Number(LocationData[num].StartPieces)));
                                    }
                                }
                            }
                            else {
                                var length = LocationData.length;
                                for (var num = 2; num < Number(length) ; num++) {
                                    if (Number(AssignedPieces) <= Number(TotalPieces)) {
                                        strLocationData = strLocationData + "<tr><td style='border:1px solid black; padding-right:10px' align='center'><span id='spnULDNo'>" + (Number(LocationData[num].StartPieces) > 0 ? "" : (LocationData[num].ULDNo != "BULK" ? LocationData[num].ULDNo : "")) + "</span></td><td style='border:1px solid black; padding-right:10px' align='center'><span id='spnHAWBNo'>" + (LocationData[num].HAWBNo != "" ? LocationData[num].HAWBNo : "") + "</span></td><td class='auto-style36' style='border:1px solid black;' align='center'><span id='spnStartPiece'>" + (LocationData[num].StartPieces != "0" ? LocationData[num].StartPieces : "") + "</span></td><td class='auto-style36' style='border:1px solid black;' align='center'><span id='spnEndPiece'>" + (Number(TotalPieces) >= Number(LocationData[num].EndPieces) ? ((Number(TotalPieces) - Number(AssignedPieces)) >= LocationData[num].EndPieces ? LocationData[num].EndPieces : (Number(LocationData[num].StartPieces) == 1 ? (Number(TotalPieces) - Number(AssignedPieces)) : LocationData[num].EndPieces)) : Number(TotalPieces)) + "</span></td><td class='auto-style36' style='border:1px solid black;' align='center'><span id='spnLocation'>" + (LocationData[num].AssignLocation != "" ? LocationData[num].AssignLocation : LocationData[num].MovableLocation) + "</span></td><tr>";
                                        AssignedPieces = Number(AssignedPieces) + (Number(LocationData[num].StartPieces) == 1 ? Number(LocationData[num].EndPieces) : (Number(LocationData[num].EndPieces) - Number(LocationData[num].StartPieces)));
                                    }
                                }
                            }
                        }
                        $('#Locationtrans1').html(strLocationData);
                        if (strLocationData == "") {
                            $("#table2").hide();
                            $("#pagebreak2").removeClass('pagebreak', '').removeClass('watermark', '').text('');
                        }

                        var StorageRemarks = "";
                        if (StorageData.length > 0) {
                            StorageRemarks = "Free Storage ";
                            for (var num = 0; num < StorageData.length; num++) {
                                StorageRemarks = StorageRemarks + "</br>" + (" For " + StorageData[num].PartNo + "Till " + StorageData[num].FOCTime + " /" + $("#spnRemarks1").html());
                            }

                            $("#spnRemarks1").html(StorageRemarks);
                        }
                    }
                    else {
                        $("#table2").hide();
                        $("#pagebreak2").removeClass('pagebreak', '').removeClass('watermark', '').text('');
                    }
                },
                error: function (err) {
                    if (err.responseText.toLowerCase().indexOf("object reference not set") != -1) {
                        document.cookie = "UserDetail=0";
                        location.href = '../../Account/' + userContext.SysSetting.LoginPage + '?islogout=true';
                    }
                }
            });
        }
    </script>
</head>
<body>
    <form id="form1">
        <!--<div id="background">-->
        <!--<p id="bg-text">Cancelled</p>-->
        <!--</div>-->

        <div id="divPrint1">
            <div class="watermark">
                Original
            </div>
        </div>
        <div class="example"></div>
        <div id="divPrint2">
            <div class="watermark">
                Copy 1
            </div>
        </div>
        <div class="example"></div>
        <div id="divPrint3">
            <div class="watermark">
                Copy 2
            </div>
        </div>
        <div class="example"></div>
        <div id="divPrint4">
            <div class="watermark">

            </div>
        </div>
        <div id="content">
            <table id="table1">
                <tr>
                    <td>
                        <!--<table style="width: 100%; background-color: rgba(0, 0, 255, 0.07); padding: 0px;">
                            <tr>
                                <td style="font-size:12pt; font-weight:bold; height:30px; width:35% " valign="top"></td>
                                <td rowspan="3" valign="top" style="font-size:14pt;">
                                    <span style="margin-top: -69px;"><img src="pic/SAS-Logo.png" /></span>
                                </td>
                                <td></td>
                            </tr>
                            <tr>
                                <td style="font-size: 12pt; font-weight: bold; height: 30px; "></td>
                            </tr>
                            <tr>
                                <td style="font-size: 12pt; font-weight: bold; height: 30px;"></td>
                            </tr>
                        </table>-->
                        <!--<table style="width: 100%; padding: 0px; margin: 0px; background-color: rgba(0, 0, 255, 0.07);" align="center" cellspacing="5px">-->
                        <table style="width: 100%; padding: 0px; margin: 0px;border:solid 1px;" cellpadding="0px" align="center" cellspacing="0px">
                            <tr>
                                <td align="center" class="auto-style1" colspan="3">DELIVERY ORDER <span id="spnReprintCount"></span></td>
                            </tr>
                            <tr>
                                <td align="center" colspan="3"></td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; padding:0px; margin:0px;" cellspacing="5px">
                                        <tr>
                                            <td class="auto-style3" rowspan="2">
                                                To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <!--Custom Department-->
                                               
                                                <br />
                                              
                                                <span id="spnairplinename"></span>
                                                <br />
                                                <br />
                                                The consignment listed below is to be cleared for delivery to :
                                                &nbsp;
                                            </td>
                                            <td align="right" class="auto-style39">
                                                DO No
                                            </td>
                                            <td style="border:1px solid black; width:25%">
                                                <span id="spnDONo"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="right" class="auto-style39">
                                                Date
                                            </td>
                                            <td style="border:1px solid black; width:25%">
                                                <span id="spnDate"></span>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; margin:0px;" cellspacing="5px" padding="0px">
                                        <tr>
                                            <td style="width:10%;">
                                                Consignee
                                            </td>
                                            <td style="border:1px solid black;height:40px;width:80%;vertical-align:top;">
                                                <span id="spnConsignee"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:10%;">
                                                Notify
                                            </td>
                                            <td style="border:1px solid black;height:40px; vertical-align:top;">
                                                <span id="spnNotify"></span>
                                                &nbsp;
                                            </td>
                                        </tr>
                                    </table>
                                    <table style="width:100%; margin:0px; padding:0px;" cellspacing="5px" align="center">

                                        <tr>
                                            <td align="center" style="width:15%;">
                                                Air waybill No.
                                            </td>
                                            <td align="center" style="width:13%;">
                                                HAWB No
                                            </td>
                                            <td style="width:55%;"></td>
                                            <td align="center" style="width:5%;">
                                                CC/PP
                                            </td>
                                            <td align="center" style="width:20%;">
                                                Rct. No./Date
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border:1px solid black; vertical-align:center; height:40px;" align="center"
                                                <span id="spnAirWaybillNo"></span>
                                            </td>
                                            <td style="border:1px solid black; vertical-align:center; height:40px;" align="center">
                                                <span id="spnHawbValue"></span>
                                            </td>
                                            <td align="center"><div style="width:205px"><span id="spnBarCode"></span></div></tdalign>
                                            <td align="center" style="border:1px solid black;height:40px;">
                                                <span id="spnCCPP"></span>
                                            </td>
                                            <td style="border:1px solid black; height:40px;" align="center">
                                                <span id="spnRctNoAndDate"></span>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; padding:0px; margin:0px;" cellspacing="5px" id="tabletrans"></table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; padding:0px; margin:0px;" cellspacing="5px">
                                        <tr>
                                            <td colspan="3">
                                                REMARKS
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3" style="border:1px solid black; vertical-align:top;overflow:auto;" class="auto-style40">
                                                <span id="spnRemarks"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3" style="border:1px solid black; vertical-align:top;overflow:auto;" class="auto-style40">
                                                <span id="spnDefaultRemarks">If Shipment not cleared due to any reason, GA will not be responsible for returned Cargo unless "RECEIVED" Stamped and signed by Delivery Staff, RECEIPT</span><br />
                                                Pcs: <span id="spntp"></span> / Wt: <span id="spnwt"></span>
                                            </td>
                                        </tr>
                                        <!--<tr>
                                            <td colspan="3" align="left">
                                                Location
                                            </td>
                                        </tr>-->
                                        <tr>
                                            <!--<td colspan="3" align="center" style="border:1px solid black; padding-right:10px; vertical-align:top;">
                                                <span id="spnLocation">
                                                </span>
                                            </td>-->
                                            <td colspan="3" align="center">
                                                <table style="width:100%; padding:0px; margin:0px;" cellspacing="0px" id="Locationtrans"></table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" style="width:95%" align="center">
                                                Particulars
                                            </td>
                                            <td align="center" style="width:5%">
                                                Amount(<span id="spnCurrency1"></span>)
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="left" style="border:1px solid black;padding-left:10px;height:100px; vertical-align:top;">
                                                <span id="spnParticulars">
                                                </span>
                                            </td>
                                            <td align="right" style="width:5%; border:1px solid black; padding-right:10px; vertical-align:top; height:100px;">
                                                <span id="spnAmount">
                                                </span>
                                            </td>
                                        </tr>
                                        <!--<tr>
                                            <td colspan="2"  style=" vertical-align:top;">
                                                Total Amount In Words :
                                            </td>
                                        </tr>-->
                                        <tr id="Total">
                                            <td style=" border:1px solid black; vertical-align:top; width:90%" rowspan="2">
                                                Total Amount In Words : <span id="spntotalamountinwords"></span>
                                            </td>
                                            <td colspan="1" align="Right" style=" vertical-align:top; border:0px solid black; width:5%;" rowspan="2">
                                                Total
                                            </td>
                                            <td align="right" style="width:5%; border:1px solid black;" rowspan="2">
                                                <span id="spnTotal"></span>
                                            </td>

                                        </tr>
                                        <tr>
                                            <td></td>

                                        </tr>
                                        <!--<tr></tr>-->

                                        <tr>
                                            <td colspan="3" align="left" style=" vertical-align:top; font-family:Arial;">
                                                All vehicles carrying cargo must exit only through Customs at the Main Gate of Freight Centre**
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="left" style=" vertical-align:top; font-family:Arial;">
                                               <!-- Charges are rounded up @ AED 5.00-->
                                                Charges are rounded up @  <span id="spnCurrency3"></span> 
                                            </td>
                                            <td align="left" style="width:40%; ">
                                                &nbsp;
                                            </td>
                                        </tr>
                                        <!--<tr>
                                            <td colspan="2" align="left" style=" vertical-align:top;">
                                                &nbsp;
                                            </td>
                                            <td align="left" style="width:40%; ">
                                                &nbsp;
                                            </td>
                                        </tr>-->
                                        <tr>
                                            <td colspan="2" align="left" style=" vertical-align:top;">
                                                &nbsp;
                                            </td>
                                            <td align="left" style="width:40%; ">
                                                &nbsp;
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="center" style=" vertical-align:top;">
                                                <span id="spnNameSignature"></span>
                                            </td>
                                            <td align="center" style="width:40%; ">
                                                <span id="spnStaff"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="center" style=" vertical-align:top;">
                                                <hr style="width:200px; border: .5px solid black" />
                                                Name &amp; Signature
                                            </td>
                                            <td align="center" style="width:40%; ">
                                                <hr style="width:250px; border: .5px solid black" />
                                                Staff
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>

            <div id="pagebreak3" class="pagebreak"><div class="watermark"></div> </div>
            <table id="table3">
                <tr>
                    <td>
                        <table style="width: 100%; padding: 0px; margin: 0px;border:solid 1px;" cellpadding="0px" align="center" cellspacing="0px">
                            <tr>
                                <td align="center" class="auto-style1" colspan="3">DELIVERY ORDER <span id="spnReprintCount2"></span></td>
                            </tr>
                            <tr>
                                <td align="center" colspan="3"></td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; padding:0px; margin:0px;" cellspacing="5px">
                                        <tr>
                                            <td class="auto-style3" rowspan="2">
                                                To:<br />
                                              
                                                <span id="spnairplinenamepage3"></span><br />
                                             <br />
                                                <br />
                                                The consignment listed below is to be cleared for delivery to :
                                                &nbsp;
                                            </td>
                                            <td align="right" class="auto-style39">
                                                DO No
                                            </td>
                                            <td style="border:1px solid black; width:25%">
                                                <span id="spnDONo2"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="right" class="auto-style39">
                                                Date
                                            </td>
                                            <td style="border:1px solid black; width:25%">
                                                <span id="spnDate2"></span>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; margin:0px;" cellspacing="5px" padding="0px">
                                        <tr>
                                            <td style="width:10%;">
                                                Consignee
                                            </td>
                                            <td style="border:1px solid black;height:40px;width:80%;vertical-align:top;">
                                                <span id="spnConsignee2"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:10%;">
                                                Notify
                                            </td>
                                            <td style="border:1px solid black;height:40px; vertical-align:top;">
                                                <span id="spnNotify2"></span>
                                                &nbsp;
                                            </td>
                                        </tr>
                                    </table>
                                    <table style="width:100%; margin:0px; padding:0px;" cellspacing="5px" align="center">

                                        <tr>
                                            <td align="center" style="width:15%;">
                                                Air waybill No.
                                            </td>
                                            <td align="center" style="width:13%;">
                                                HAWB No
                                            </td>
                                            <td style="width:55%;"></td>
                                            <td align="center" style="width:5%;">
                                                CC/PP
                                            </td>
                                            <td align="center" style="width:20%;">
                                                Rct. No./Date
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border:1px solid black; vertical-align:top; height:40px;" align="center">
                                                <span id="spnAirWaybillNo2"></span>
                                            </td>
                                            <td style="border:1px solid black; vertical-align:top; height:40px;" align="center">
                                                <span id="spnHawbValue2"></span>
                                            </td>
                                            <td align="center"><div style="width:205px;"><span id="spnBarCode2"></span></div></td>
                                            <td align="center" style="border:1px solid black;height:40px;">
                                                <span id="spnCCPP2"></span>
                                            </td>
                                            <td style="border:1px solid black; height:40px;" align="center">
                                                <span id="spnRctNoAndDate2"></span>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; padding:0px; margin:0px;" cellspacing="5px" id="tabletrans2"></table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; padding:0px; margin:0px;" cellspacing="5px">
                                        <tr>
                                            <td colspan="3" align="center">
                                                <table style="width:100%; padding:0px; margin:0px;" cellspacing="0px" id="Locationtrans"></table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" style="width:95%" align="center">
                                                Particulars
                                            </td>
                                            <td align="center" style="width:5%">
                                                Amount(<span id="spnCurrency2"></span>)
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="left" style="border:1px solid black;padding-left:10px;height:100px; vertical-align:top;">
                                                <span id="spnParticulars2">
                                                </span>
                                            </td>
                                            <td align="right" style="width:5%; border:1px solid black; padding-right:10px; vertical-align:top; height:100px;">
                                                <span id="spnAmount2">
                                                </span>
                                            </td>
                                        </tr>

                                        <tr id="Total2">

                                            <td style=" border:1px solid black; vertical-align:top; width:90%" rowspan="2">
                                                Total Amount In Words : <span id="spntotalamountinwords2"></span>
                                            </td>
                                            <td colspan="1" align="Right" style=" vertical-align:top; border:0px solid black; width:5%;" rowspan="2">
                                                Total
                                            </td>
                                            <td align="right" style="width:5%; border:1px solid black;" rowspan="2">
                                                <span id="spnTotal2"></span>
                                            </td>
                                        </tr>
                                        <tr></tr>
                                        <tr>
                                            <td colspan="3" align="left" style=" vertical-align:top; font-family:Arial;">
                                                All vehicles carrying cargo must exit only through Customs at the Main Gate of Freight Centre**
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="left" style=" vertical-align:top; font-family:Arial;">
                                                <!--Charges are rounded up @ AED 5.00-->
                                                Charges are rounded up @  <span id="spnCurrency4"></span> 

                                            </td>
                                            <td align="left" style="width:80%; ">
                                                &nbsp;
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="left" style=" vertical-align:top;">
                                                &nbsp;
                                            </td>
                                            <td align="left" style="width:40%; ">
                                                &nbsp;
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="center" style=" vertical-align:top;">
                                                <span id="spnNameSignature2"></span>
                                            </td>
                                            <td align="center" style="width:40%; ">
                                                <span id="spnStaff2"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="center" style=" vertical-align:top;">
                                                <hr style="width:200px; border: .5px solid black" />
                                                Name &amp; Signature
                                            </td>
                                            <td align="center" style="width:40%; ">
                                                <hr style="width:250px; border: .5px solid black" />
                                                Staff
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>

            <div id="pagebreak2" class="pagebreak"><div class="watermark"></div></div>
            <table id="table2">
                <tr>
                    <td>
                        <table style="width: 100%; padding: 0px; margin: 0px;border:solid 1px;" cellpadding="0px" align="center" cellspacing="0px">
                            <tr>
                                <td align="center" class="auto-style1" colspan="3">DELIVERY ORDER <span id="spnReprintCount1"></span></td>
                            </tr>
                            <tr>
                                <td align="center" colspan="3"></td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; padding:0px; margin:0px;" cellspacing="5px">
                                        <tr>
                                            <td class="auto-style3" rowspan="2">
                                                To:<br />
                                            
                                                <span id="spnairplinenamepage2"></span><br />
                                              <br />
                                                <br />
                                                The consignment listed below is to be cleared for delivery to :
                                                &nbsp;
                                            </td>
                                            <td align="right" class="auto-style39">
                                                DO No
                                            </td>
                                            <td style="border:1px solid black; width:25%">
                                                <span id="spnDONo1"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="right" class="auto-style39">
                                                Date
                                            </td>
                                            <td style="border:1px solid black; width:25%">
                                                <span id="spnDate1"></span>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; margin:0px;" cellspacing="5px" padding="0px">
                                        <tr>
                                            <td style="width:10%;">
                                                Consignee
                                            </td>
                                            <td style="border:1px solid black;height:40px;width:80%;vertical-align:top;">
                                                <span id="spnConsignee1"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:10%;">
                                                Notify
                                            </td>
                                            <td style="border:1px solid black;height:40px; vertical-align:top;">
                                                <span id="spnNotify1"></span>
                                                &nbsp;
                                            </td>
                                        </tr>
                                    </table>
                                    <table style="width:100%; margin:0px; padding:0px;" cellspacing="5px" align="center">

                                        <tr>
                                            <td align="center" style="width:15%;">
                                                Air waybill No.
                                            </td>
                                            <td align="center" style="width:13%;">
                                                HAWB No
                                            </td>
                                            <td style="width:55%;"></td>
                                            <td align="center" style="width:5%;">
                                                CC/PP
                                            </td>
                                            <td align="center" style="width:20%;">
                                                Rct. No./Date
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border:1px solid black; vertical-align:top; height:40px;" align="center"
                                                <span id="spnAirWaybillNo1"></span>
                                            </td>
                                            <td style="border:1px solid black; vertical-align:top; height:40px;" align="center">
                                                <span id="spnHawbValue1"></span>
                                            </td>
                                            <td align="center"><div style="width:205px;"><span id="spnBarCode1"></span></div>
                                            <td align="center" style="border:1px solid black;height:40px;">
                                                <span id="spnCCPP1"></span>
                                            </td>
                                            <td style="border:1px solid black; height:40px;" align="center">
                                                <span id="spnRctNoAndDate1"></span>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; padding:0px; margin:0px;" cellspacing="5px" id="tabletrans1"></table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <table style="width:100%; padding:0px; margin:0px;" cellspacing="5px">
                                        <tr>
                                            <td colspan="3" align="center">
                                                <table style="width:100%; padding:0px; margin:0px;" cellspacing="0px" id="Locationtrans1"></table>
                                            </td>
                                        </tr>

                                        <tr>
                                            <td colspan="3" align="left" style=" vertical-align:top; font-family:Arial;">
                                                All vehicles carrying cargo must exit only through Customs at the Main Gate of Freight Centre**
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="left" style=" vertical-align:top; font-family:Arial;">
                                               <!-- Charges are rounded up @ AED 5.00-->
                                                Charges are rounded up @  <span id="spnCurrency5"></span> 
                                            </td>
                                            <td align="left" style="width:40%; ">
                                                &nbsp;
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="left" style=" vertical-align:top;">
                                                &nbsp;
                                            </td>
                                            <td align="left" style="width:40%; ">
                                                &nbsp;
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="center" style=" vertical-align:top;">
                                                <span id="spnNameSignature1"></span>
                                            </td>
                                            <td align="center" style="width:40%; ">
                                                <span id="spnStaff1"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" align="center" style=" vertical-align:top;">
                                                <hr style="width:200px; border: .5px solid black" />
                                                Name &amp; Signature
                                            </td>
                                            <td align="center" style="width:40%; ">
                                                <hr style="width:250px; border: .5px solid black" />
                                                Staff
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>

        </div>
    </form>
</body>
</html>
