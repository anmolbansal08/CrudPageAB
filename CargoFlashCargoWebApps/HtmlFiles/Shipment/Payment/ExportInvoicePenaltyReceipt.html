<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head id='head1'>
    <title>RECEIPT NOTE</title>
    <!--<script src="../../../Scripts/jquery-1.7.2.js" type="text/javascript"></script>
    <script src="../../../Scripts/json2.js"></script>
    <script src="../../../Scripts/JqueryPrint.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {

            if (window.opener)
                userContext = window.opener.parent.userContext;


            GetChargeNotePrint();

            var LogoURL = getParameterByName("LogoURL", "");


            $('#ImgLogo').attr('src', LogoURL);

        });

        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        function GetChargeNotePrint() {

            var InvoiceSNo = getParameterByName("InvoiceSNo", "");
            var InvoiceType = getParameterByName("InvoiceType", "");
            var UserSNo = getParameterByName("UserSNo", "");
            UserSNo = UserSNo == "" ? "0" : UserSNo;
            $.ajax({
                url: "../../../Services/Shipment/PaymentService.svc/GetPaymentExportInvoicePrint",
                async: false,
                type: "GET",
                dataType: "json",
                data: { InvoiceSNo: InvoiceSNo, InvoiceType: InvoiceType, UserSNo: UserSNo },
                contentType: "application/json; charset=utf-8", cache: false,
                success: function (result) {
                    //alert(data); // this is Json data object

                    var ResultData = jQuery.parseJSON(result);
                    var FinalData = ResultData.Table0 || [];
                    var OtherChargeTab = ResultData.Table1 || [];
                    var FinalData1 = ResultData.Table2 || [];
                    var FinalData2 = ResultData.Table4 || [];

                    var TrOtherCharges = "";
                    var TrOtherChargesDueAgent = "";
                    var TrOtherChargesDueChargesCarrier = "";
                    var TrAWB = "";
                    var totalOther = 0;
                    var freightTax = 0;
                    var totalFreghtCharge = 0;
                    var totalFreghtCharge_totalawbCharges = 0;
                    FinalData1.forEach(function (item) {
                        //Due Carrier--Due Agent
                        if (item.TariffCode.indexOf('FREIGHT') == -1) {
                            TrOtherCharges += '<tr><td colspan="3" class="pdLeft">' + item.TariffCode + '</td>' +
                                '<td  id="spnFEK">' + item.ChargeValue + '</td></tr>';
                            totalOther += parseFloat(item.ChargeValue);
                        }
                    });
                    // WareHouse
                    OtherChargeTab.forEach(function (item) {
                        if (item.ChargeType == 'DC') {
                            TrOtherChargesDueChargesCarrier += '<tr><td colspan="3" class="pdLeft">' + item.OtherchargeDetail + '</td>' +
                                '<td  id="spnDueChg">' + item.ChargeValue + '</td></tr>';
                            totalOther += parseFloat(item.ChargeValue);
                        }
                        else if (item.ChargeType == 'DA') {
                            TrOtherChargesDueAgent += '<tr><td colspan="3" class="pdLeft">' + item.OtherchargeDetail + '</td>' +
                                '<td  id="spnDueAgent">' + item.ChargeValue + '</td></tr>';
                            totalOther += parseFloat(item.ChargeValue);
                        }
                    });

                    FinalData1.forEach(function (piece) {
                        if (piece.TariffCode.indexOf('FREIGHT') != -1) {
                            if (piece.TariffCode != "FREIGHT TAX") {
                                TrAWB += '<tr><td colspan="3" class="pdLeft">' + piece.TariffCode + '</td>' +
                                    '<td  id="spnJEK">' + piece.ChargeValue + '</td></tr>';
                                totalFreghtCharge_totalawbCharges += parseFloat(piece.ChargeValue);
                            }
                        }
                    });


                    FinalData1.forEach(function (piece) {
                        if (piece.TariffCode.indexOf('FREIGHT') != -1) {
                            if (piece.TariffCode == "FREIGHT TAX") {
                                freightTax += parseFloat(piece.ChargeValue);
                            }
                        }
                    });

                    freightTax = parseFloat(FinalData1[0].TotalAmount1) + parseFloat(freightTax);

                    ////FinalData1.forEach(function (piece) {
                    ////    if (piece.TariffName.toUpperCase() == "FREIGHT CHARGE") {

                    ////        TrAWB += '<tr><td colspan="2" class="pdLeft">' + piece.TariffName + '</td>' +
                    ////        '<td  id="spnJEK">' + piece.ChargeValue + '</td></tr>';
                    ////    }
                    ////});

                    //if (item.TariffName.toUpperCase() != "FREIGHT CHARGE") {
                    //    TrOtherCharges += '<tr><td colspan="2" class="pdLeft">' + item.TariffName.toUpperCase() + '</td>' +
                    //    '<td  id="spnFEK">' + item.ChargeValue + '</td></tr>';
                    //}



                    if (FinalData.length > 0 && FinalData != null) {
                        if (FinalData[0].ValuationCharge != undefined && FinalData[0].ValuationCharge != '') {
                            TrAWB += '<tr><td colspan="2" class="pdLeft">Valuation Charge</td>' +
                                '<td  id="spnJEK">' + FinalData[0].ValuationCharge + '</td></tr>';
                            totalFreghtCharge += parseFloat(FinalData[0].ValuationCharge);
                        }


                        $('#TrOtherCharges').after(TrOtherCharges);
                        $('#TrOtherChargesDueAgent').after(TrOtherChargesDueAgent);
                        $('#TrOtherChargesDueChargesCarrier').after(TrOtherChargesDueChargesCarrier);


                        $('#TrAWB').after(TrAWB);

                        $('#spnAirlineName').text(FinalData[0].AirlineName);

                        $('#spnAddress').text(FinalData[0].AirlineAddress);
                        $("#spnDate").text(FinalData1[0].Date);
                        $("#spnRefNo").html(FinalData[0].RefNo);
                        $("#spnTime").text(FinalData1[0].Time);
                        //$("#spnTaxid").text(FinalData[0].Page)
                        //$("#spnspnNoPKP").text(FinalData[0].PaymentMode);
                        $("#spnTanggal").text(FinalData[0].TanggalDate);
                        $('#spnStaff').text(FinalData[0].StaffName);
                        $("#spnAWBno").text(FinalData[0].AWBNo);
                        $("#spnNoOfPieces").text(FinalData[0].TotalPieces);
                        //$("#spnPartyAgentName").html((FinalData[0].AgentCode == "" || FinalData[0].AgentCode == undefined) ? FinalData[0].AccountName : FinalData[0].AgentCode + "  " + FinalData[0].AccountName);


                        $("#spnCustCode").html(FinalData[0].AccountCode);
                        $("#spntotalweight").text(FinalData[0].TotalChargeableWeight);
                        $("#spnCustName").text(FinalData[0].CustomerName);

                        $("#spnNOG").text(FinalData[0].NatureOfGoods);
                        $("#spnCustnTax").text(FinalData[0].CustomerAddress.slice(0, FinalData[0].CustomerAddress.length - 1));




                        $("#spnOD").text(FinalData[0].OriginDest);
                        $("#spnFNo").text(FinalData[0].FlightNo);
                        $("#spnPlaceofIssue").html(FinalData[0].PlaceOfIssue);
                        $("#spnCurrency").text(FinalData1[0].Currency);
                        $("#spnCurrency1").text(FinalData1[0].Currency);
                        $("#spnTotal").text(FinalData1[0].TotalAmount);
                        $("#spnTotal2").text(FinalData1[0].TotalAmount);
                        // $("#spntia").text(FinalData1[0].TotalAmount);
                        $("#spnVAT").text(FinalData2[0].OtherChargesTax);
                        //$("#spnVAT").text(freightTax);

                        //////$("#spnFcharg").html(FinalData[0].ReceiptDoneOn);
                        //$("#spnDisGATF").html(FinalData[0].AWBNo);
                        //$("#spnValcharge").html(FinalData[0].ValuationCharge);
                        //$("#spnTAWBcharge").val(totalFreghtCharge);
                        //$('#spnTAWBcharge').text(totalFreghtCharge_totalawbCharges);
                        $('#spnTAWBcharge').text(FinalData2[0].TotalAWBCharges);
                        //$('#spnTOC').text(totalOther);
                        $("#spnTOC").html(FinalData2[0].TotalOtherCharges);

                        //$("#spnFEK").html(FinalData[0].HAWBNo);
                        //$("#spnMS").html(FinalData[0].ReceiptDoneBy);

                        $("#spnFOP").html(FinalData1[0].PaymentMode);
                        $("#spnISUDy").html(FinalData[0].StaffName);
                        $("#isFinal").html(ResultData.Table3[0].IsFinal);
                        ////$("#spnAPProv").html(FinalData1[0].UserName);
                        //$("#spnRemarks").html(FinalData[0].ReceiptDoneBy);




                        //if (FinalData[0].PrintCount > 0) {
                        //    $('#spnReprint').html('(RE PRINT)');
                        //}
                        //else {
                        //    $('#spnReprint').html('');
                        //}
                        //var strdata = '';
                        ////var totalamount = 0;

                        ////strdata = strdata + " <tr><td colspan='6' ><hr size='1' /></td></tr><tr><th align='left'>AWB NO :</th><th align='left'>CUSTOMER CODE & ACCOUNT CODE</th><th align='right'>Amount </th><th align='left'></th></tr><tr><td colspan='6'><hr size='1' /></td></tr>"

                        //strdata = strdata + " <tr><td colspan='6'></td></tr><tr><td align='left'>AWB/ULD :&nbsp;&nbsp;&nbsp;&nbsp;" + FinalData[0].AWBNo + "</td><td align='left'>Pcs/Wt :&nbsp;&nbsp;&nbsp;&nbsp;" + FinalData[0].TotalPieces + "/" + FinalData[0].TotalGrossWeight + "</td><td align='left'></td></tr><tr><td colspan='6'></td></tr>";//Lot No :   " + FinalData[0].SLINo + "
                        //for (var num = 0; num < FinalData.length; num++) {
                        //    strdata = strdata + "<tr><td style='padding: 5px; font-size:11px'>" + FinalData[num].PaymentMode + "</td><td style='padding: 5px; font-size:11px'>" + (FinalData[num].PaymentMode == "CASH" ? "" : FinalData[num].ChequeNumber) + "</td><td id='spnAWBAmountRemarks' style='padding: 5px; font-family:Verdana;font-size:11px' align='right'>" + (FinalData[num].PaymentMode == "CASH" ? FinalData[num].CashAmount : FinalData[num].ChequeAmount) + "</td><td id='spnSLINo' style='padding: 5px; font-family:Verdana;font-size:11px'></td></tr>";
                        //}
                        //for (var num = 0; num < FinalData1.length; num++) {
                        //    strdata = strdata + "<tr><td style='padding: 5px; font-size:11px'>" + FinalData1[num].PaymentMode + "</td><td style='padding: 5px; font-size:11px'>" + FinalData1[num].TransactionNo + "</td><td id='spnAWBAmountRemarks' style='padding: 5px; font-family:Verdana;font-size:11px' align='right'>" + FinalData1[num].Amount + "</td><td id='spnSLINo' style='padding: 5px; font-family:Verdana;font-size:11px'></td></tr>";
                        //}
                        //strdata = strdata + " <tr><td colspan='6'><hr size='1' /></td></tr><tr><td>Currency:&nbsp; <span id='spnCurrency'></span></td><td align='right'>Total Amount:</td><td align='right' id='spnTotalAmount'></td><td align='right' style='width:50px' id='spnPaymentMode'></td><td></td></tr><tr><td colspan='7'><hr size='1' /></td></tr>";
                        //$('#trdetail').html(strdata);
                        //$("#spnCurrency").html(FinalData[0].Currency);
                        //$("#spnCurrencyCode").html(FinalData[0].Currency);
                        //$('#spnTotalAmountInword').html(FinalData[0].TotolAmountInWord)
                        //$("#spnTotalAmount").html(FinalData[0].TotalAmount);
                        ////$("#spnPaymentMode").html("(" + FinalData[0].PaymentMode + ")")


                    }
                },
                error: function (err) {
                    alert("Generated error");
                }
            });
        }


        function funPrint(divID) {
            var divContents = $("#" + divID).html();
            var printWindow = window.open('', '', '');
            printWindow.document.write(divContents);
            printWindow.document.close();
            printWindow.print();
        }

    </script>-->
</head>
<body>
    <div id="printPayment" style="padding: 5px; font-family: Verdana; font-size: 11px; ">
        <table style="width: 900px; border: 1px solid black;">



            <tr>
                <td colspan='4' id="Imglogo">
                    <img src="../../../Logo/ExportInvoiceLogo.png" />
                </td>
            </tr>


            <tr>
                <td style="font-size:14px;font-weight:500;">Address <span class="floatRight">:</span></td>
                <td>
                    <span id="spnAirlineName"></span><br />

                    <span id="spnAddress"></span>

                </td>
                <td style="font-size:14px;font-weight:500;">Ref No:</td>

                <td id='spnRefNo'></td>


            </tr>

            <tr>
                <td style="font-size:14px;font-weight:500;">Tax Id<span class="floatRight">:</span></td>
                <td id="spnTaxid">
                    01.001.634.3-093.000
                </td>

            </tr>

            <tr>
                <td style="font-size:14px;font-weight:500;">No Pengukuhan PKP<span class="floatRight">:</span></td>
                <td id="spnNoPKP">
                    No. 051.00095.01.89
                </td>

                <td style="font-size:14px;font-weight:500;">Tanggal:</td>
                <td id="spnTanggal"></td>

            </tr>



            <tr style="height:100px;">
                <td colspan="4" style="font-size: 14px; font-weight: 900; text-align: center; ">
                    EXPORT INVOICE / RECEIPT <br />
                    <span id="isFinal">
                        DRAFT / FINAL
                    </span>
                </td>


            </tr>
            <tr>
                <td style="font-size:14px;font-weight:500;">Date of Issued<span class="floatRight">:</span></td>
                <td id="spnDate"></td>
                <td colspan="2"></td>


            </tr>

            <tr>
                <td style="font-size:14px;font-weight:500;">Time<span class="floatRight">:</span></td>
                <td id="spnTime"></td>
                <td colspan="2"></td>

            </tr>

            <tr>
                <td style="font-size:14px;font-weight:500;">Staff Name<span class="floatRight">:</span></td>
                <td id="spnStaff"></td>

                <td colspan="2"></td>

            </tr>

        </table>


        <table style="width: 900px; border: 1px solid black;">






            <tr>
                <td class="tdfonts">AWB No<span class="floatRight">:</span></td>
                <td id="spnAWBno"></td>
                <td class="tdfonts">NO. OF PIECES<span class="floatRighte">:</span></td>
                <td id="spnNoOfPieces"> </td>
            </tr>

            <tr>
                <td class="tdfonts">CUSTOMER CODE & ACCOUNT CODE<span class="floatRight">:</span></td>
                <td id="spnCustCode"></td>


                <td class="tdfonts">TOTAL CH. WEIGHT<span class="floatRighte">:</span></td>
                <td id="spntotalweight"></td>
            </tr>




            <tr>
                <td class="tdfonts">CUSTOMER NAME<span class="floatRight">:</span></td>
                <td id="spnCustName"></td>
                <td class="tdfonts">NATURE OF GOODS<span class="floatRighte">:</span></td>
                <td id="spnNOG"> </td>
            </tr>

            <tr>
                <td class="tdfonts">CUSTOMER ADDRESS<span class="floatRight">:</span></td>
                <td style="width:150px" id="spnCustnTax">

                    <!--<td rowspan="3" style="border: 1px solid red;vertical-align:top; width:300px;">
                         <div style="text-align:center">
                         <span>Customer address and Tax Id</span>
                     </div>
                     <div id="spnCustnTax" style="text-align:center;padding-top:15px;"></div>
                     </td>

                    <td></td>-->

                <td class="tdfonts">ORIGIN/DESTINATION<span class="floatRighte">:</span></td>
                <td id="spnOD"> </td>
            </tr>

            <tr>
                <td class="tdfonts">TAX ID<span class="floatRight">:</span></td>
                <td id="spnTaxid">01.001.634.3-093.000</td>

                <td class="tdfonts">FLIGHT NUMBER<span class="floatRighte">:</span></td>
                <td id="spnFNo"> </td>
            </tr>


            <tr>
                <td colspan="2"></td>
                <td class="tdfonts">PLACE OF ISSUE<span class="floatRighte">:</span></td>
                <td id="spnPlaceofIssue"></td>
            </tr>


        </table>



        <table style="width: 900px; border: 1px solid black;">
            <tr>
                <td class="tdfonts" colspan="2">BREAKDOWN OF CHARGES</td>

                <td class="tdfont">CURRENCY:&nbsp;<span id="spnCurrency"></span></td>

                <td class="tdfont">AMOUNT</td>

                <td align="right" class="tdfont">AMOUNT</td>

            </tr>

  <!--   end  By NEHAL -->

            <!--<tr id="TrAWB">
                <td colspan="2" class="tdfonts"> AWB ISSUE</td>
                <td colspan="2" style="text-align:right" id="awbchrg"></td>
            </tr>

            <!--<tr >
                <td colspan="2" class="pdLeft"> FREIGHT CHARGES</td>
                <td id="spnFcharg" >120,000</td>

            </tr>
            <tr >
                <td colspan="2" class="pdLeft">DISCOUNT GATF 20%</td>
                <td id="spnDisGATF">22,000</td>

            </tr>-->
            <!--<tr>
                <td colspan="2" class="pdLeft"> VALUATION CHARGES</td>
                <td colspan="3" id="spnValcharge"> </td>

            </tr>-->

            <!--<tr style="height:25px;">
                <td>Total AWB Charges</td>
                <td align="right" colspan="4" id="spnTAWBcharge"> </td>
            </tr>-->



            <!-- <tr id="TrOtherCharges"> -->
            <!-- <td class="tdfonts">OTHER CHARGES</td> -->
            <!-- <td colspan ="2"style="text-align:right" id="spnOthchrg"></td> -->
            <!-- </tr> -->
            <!--<tr id="TrOtherChargesDueAgent">
                <td class="tdfonts">DUE AGENT</td>

                <td colspan="2" class="tdfonts" style="text-align:right" id="spnDueAgent"></td>


            </tr>
            <tr id="TrOtherChargesDueChargesCarrier">
                <td class="tdfonts">DUE CARRIER CHARGES</td>
                <td colspan="2" class="tdfonts" style="text-align:right" id="spnDueCharge"></td>


            </tr>-->

            <tr>
                <td style="font-size:14px;">Total Penalty Charges</td>
                <td colspan="4" id="spnTOC" style="text-align:right"></td>
            </tr>

            <!--<tr style="height:25px;">
                <td class="pdLeft">VALUE ADDED TAX</td>
                <td colspan="4" style="text-align:right" id="spnVAT"></td>
            </tr>-->

            <tr>

                <td style="font-size: 14px; font-size: 12px; font-weight: 700;">Total Invoice Amount</td>
                <td colspan="3" style="text-align:right; text-decoration:overline underline;" id="spntia"></td>

            </tr>

<!--   end  By NEHAL -->
            <tr>
                <td class="tdfonts">FORM OF PAYMENT</td>

                <td colspan="3" style="font-size:14px;font-weight:500;">CURRENCY:&nbsp;<span id="spnCurrency1"></span></td>


                <td colspan="4" style="font-size:14px;font-weight:500; text-align:right;text-decoration:overline;">AMOUNT</td>
            </tr>

            <tr style="height:25px;">

                <td id="spnFOP">
                    CASH / CREDIT CARD / TOPUP
                </td>
                <td colspan="4" style="text-align:right;font-weight:500; text-decoration:underline;" id="spnTotal"></td>

            <tr>

                <td style="font-size:14px;font-weight:600;">Total</td>


                <td colspan="4" style="text-align:right;font-weight:500; text-decoration:overline underline;" id="spnTotal2"></td>

            </tr>

            <tr>
                <td class="tdfonts">SIGNATURE OF CARD HOLDER</td>
                <td colspan="3" id="spnSIGN"><hr style="border-color:black;" /></td>
            </tr>

        </table>

        <table style="width: 900px; border : 2px solid black;">

            <tr>
                <td style="width:8%;font-size:10px;font-weight:500;">Issued by:</td>
                <td id="spnISUDy" style="width:45%"></td>

                <td style="font-size: 10px; font-weight: 500; width: 10%; ">Approved by:</td>
                <td id="spnAPProv" style="width: 0%;"></td>
            </tr>

            <tr>
                <td style="width:8%;font-size:10px;font-weight:500;">Remarks:</td>
                <td colspan="4" id="spnRemarks"></td>
            </tr>

        </table>
    </div>
    <style>
        .pdLeft {
            padding-left: 22px;
        }

        .pdRight {
            padding-right: 22px;
        }

        .tdfont {
            font-size: 14px;
            font-weight: 500;
        }

        .tdfonts {
            font-size: 14px;
            font-weight: 900;
        }

        .tp {
            padding-top: 10px;
            padding-bottom: 10px;
            text-align: center;
            padding-left: 200px;
        }

        .floatRight {
            float: right;
            margin-right: 10px;
        }

        .floatRights {
            float: left;
            margin-left: 1px;
        }

        .floatRighte {
            float: right;
            margin-right: 25px;
        }
    </style>

</body>
</html>
