<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1">
    <script src="Scripts/jquery-1.7.2.js" type="text/javascript"></script>
    <script src="Scripts/json2.js"></script>
    <script src="../Scripts/jquery-barcode-2.0.2.js"></script>
    <script src="../Scripts/html2canvas.js"></script>
    <script src="../Scripts/jspdf.debug.js"></script>


    <script type="text/javascript">

        var userContext = '';
        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!

        var yyyy = today.getFullYear();
        if (dd < 10) {
            dd = '0' + dd;
        }
        if (mm < 10) {
            mm = '0' + mm;
        }
        var today = dd + '/' + mm + '/' + yyyy;
      //  document.getElementById("DATE").value = today;

        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
              results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }
        ////////////////////////////////////////
        function isBase64(str) {
            try {
                return btoa(atob(str)) == str;
            } catch (err) {
                return false;
            }
        }

        
        $(document).ready(function () {

            var AwbNo = getParameterByName("sno", "");// "30243";
            if (isBase64(AwbNo))
                AwbNo = atob(AwbNo);
            var FinalData;
            var FinalData1;
            var url;
            //if (pageName == "Acceptance")
            //    url = "Services/Tariff/HandlingChargesService.svc/GetAWBPrintData"
            //else
            //    url = "Services/Tariff/HandlingChargesService.svc/GetImportAWBPrintData"
            url = "Services/Shipment/ReservationBookingService.svc/ReservationBookingGetPTIPrintData"
            $.ajax({
                url: url,
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ AwbNo: AwbNo}),
                async: false,
                type: 'POST',
                cache: false,
                success: function (result) {
                    //alert(data); // this is Json data object
                    var ResultData = jQuery.parseJSON(result);
                    FinalData = ResultData.Table0;
                    FinalData1 = ResultData.Table1;
                    var FinalData2 = ResultData.Table2;
                    //$("#imgAirline").tex
                    if (FinalData.length > 0) {
                        $("#imgAirline").attr({ "src": "/BLOBUploadAndDownload/DownloadFromBlob/?filenameOrUrl=" + FinalData[0].AirlineImage, height: "64px", width: "220px" });
                        $('#imgAirline').attr('onError', 'this.style.display="none";');//'this.onerror=null;this.src="/Images/Logo_Garuda_Indonesia New.jpg";'
                        //$("<img src=" + FinalData[0].AirlineImage + " alt=\"logo\" width=\"100\" />").appendTo("#imgAirline");
                       // $("#imgAirline").attr({ "src": FinalData[0].AirlineImage, height: "32px", width: "220px" });
                        $("#spnShipername").text(FinalData[0].ShipperName);
                        $("#spnShiperaddress").text(FinalData[0].ShipperAddress);
                        $("#spnShiperphone").text(FinalData[0].ShipperPhone);
                        $('#spnShiperidentity').text(FinalData[0].ConsigneeName);
                        $("#spnConsineename").text(FinalData[0].ConsigneeName);
                        $("#spnConsineeaddress").text(FinalData[0].ConsigneeAddress);
                        $("#spnConsineephone").text(FinalData[0].ConsigneePhone);
                        $('#spnGrosswt').text(FinalData[0].GrossWeight);
                        $('#spnPcs').text(FinalData[0].Piece);
                        $('#spneoc').text(FinalData[0].ExplanationofContents);
                        $('#spnAWBNo').text(FinalData[0].AWBNo);
                        $('#spnShiperidentity').text(FinalData[0].IDcard);
                        $('#tspnGrosswt').text(FinalData[0].GrossWeight);
                        $('#spndate').text(today);                                               
                         AWBPrintPTI();
                    }                  
                },
                error: function (err) {
                    alert("Generated error");
                }
            });
        });      

        function AWBPrintPTI() {       
            var PDFCode = $("#spnAWBNo").text();
         

            var pdf = new jsPDF('p', 'pt', 'a4');      //jsPDF('orientation','unit','paper-size')

            pdf.internal.scaleFactor = 1.3;      //scale the display of element on pdf

            pdf.setDisplayMode ("100%","continuous")
            
            pdf.addHTML(document.body, 35, 10, { pagesplit: true, width: 820}, function () {

                pdf.save(PDFCode+ '.pdf');        //save pdf onLoad
                window.close();
            });
        }

    </script>  
</head>
<!--<body text="#000000" bgcolor="#ffffff" leftmargin="0" topmargin="0">-->
    <body>
        
        <form id="aspnetForm" runat="server">
                <div id="Div41" class="WebFormTable" style="border: 2px solid #CCC; width: 700px; ">
                    <br />

                    <table cellpadding="6" width="100%" >

                        <tr>
                            <td colspan='6' align="center">
                                <div id="logo"><img src="" id="imgAirline" alt="not available"> </img></div>
                                <h2>PEMBERITAHUAN TENTANG ISI(PTI)</h2>
                            </td>
                        </tr>
                       
                    </table>
                    <table cellpadding="6" width="100%" style=" font-family: Arial, Helvetica, sans-serif; font-size: 12px;">

                        <tr>
                            <td colspan='2'>Yang bertanda tangan dibawah ini:</td>
                        </tr>
                        <tr>
                            <td colspan='1'>Nama Pengirim</td>
                            <td colspan='1'>:&nbsp;  &nbsp; <span id="spnShipername"></span></td>
                        </tr>
                        <tr>
                            <td colspan='1'>Alamat</td>
                            <td colspan='1'>:  &nbsp;  &nbsp;<span id="spnShiperaddress"></span></td>
                        </tr>
                        <tr>
                            <td colspan='1'>Nomor Telepon</td>
                            <td>:  &nbsp;  &nbsp;<span id="spnShiperphone"></span></td>
                        </tr>
                        <tr>
                            <td colspan='1'>KTP/Identitas Iainya</td>
                            <td> : &nbsp;  &nbsp; <span id="spnShiperidentity"></span></td>
                        </tr>
                        <tr>
                            <td colspan='2'>Menerangkan, bahwa kirimani yang diserahkan untuk diangkut oleh Arilines yang dialamatkan kepada:</td>

                        </tr>
                        <tr>
                            <td colspan='1'>Nama Penerima</td>
                            <td colspan='1'>:  &nbsp;  &nbsp;<span id="spnConsineename"></span></td>
                        </tr>
                        <tr>
                            <td colspan='1'>Alamat</td>
                            <td colspan='1'>:  &nbsp;  &nbsp;<span id="spnConsineeaddress"></span></td>
                        </tr>
                        <tr>
                            <td colspan='1'>Nomor Telepon</td>
                            <td colspan='1'>:  &nbsp;  &nbsp;<span id="spnConsineephone"></span></td>
                        </tr>
                        <tr>
                            <td colspan='1'>Dengan Surat Muatan Udara No</td>
                            <td colspan='1'>:  &nbsp;  &nbsp;<span id="spnAWBNo"></span></td>
                        </tr>
                        <tr>
                            <td colspan='2'>Berisi barang-barang sebagai berikut :</td>
                        </tr>
                    </table>
                    <br><br>

                    <table border="1" cellpadding="2" cellspacing="0"  width="100%" style="text-align: center; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">

                        <tr>
                            <th>JUMLAH KOLI</th>
                            <th>SATUAN</th>
                            <th>ISI BARANG</th>
                            <th>BERAT KG</th>
                        </tr>
                        <tr>
                            <td><span id="spnPcs"></span></td>
                            <td>KG</td>
                            <td><span id="spneoc"></span></td>
                            <td><span id="spnGrosswt"></span></td>
                        </tr>
                    </table>
                    <br />
                    <table cellpadding="6" width="100%" style="text-align: center; font-family: Arial, Helvetica, sans-serif; font-size: 12px; " >

                        <tr>
                            <td colspan='4' align="right"><b>JUMLAH BERAT :&nbsp;</b><span id="tspnGrosswt"></span>   &nbsp;KG</td>
                        </tr>
                    </table>
                    <p style="text-align:justify;width:100%;">
                        Selain itu, apabila pengisian formulir ini ternyata tidak benar maka perngirim bersedia dikenakan sanksi sesuai peraturan perundang-undangan.
                        pengirim menerangkan pula bahwa ia bersedia sewaktu-waktu membayar ganti rugi yang disebabkan karena pemberitahuan tentanga isi telah diisi tidak
                        dengan sebenarnya.
                    </p>
                    <br />

                    <table cellpadding="6" width="100%" style="text-align: center; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">

                        <tr>
                            <td colspan='4' align="right"><span>..................................................................</span></td>
                        </tr>
                    </table>

                    <br />
                    <table cellpadding="6" width="100%" style="text-align: center; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">

                        <tr>
                            <td colspan='4' align="right">(Tanda Tangan & Nama Jelas Pengirim)</td>
                        </tr>
                    </table>
                    <br /><br /><br /><br /><br />
                    <table cellpadding="6" width="100%" style="text-align: center; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">
                        <tr>
                            <td colspan='1' align="left"><b>LA-CF-03-07.F.14</b></td>
                            <td colspan='1' align="left"><b>Revision 02</b></td>
                            <td colspan='1' align="right"><b><span id="spndate"></span></b></td>
                        </tr>
                    </table>
                </div>
        </form>
    </body>
</html>
